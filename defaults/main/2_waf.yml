---

defaults_waf:
  # NOTE: the block-code is very limited if you want to use an errorfile!
  #   see: https://www.haproxy.com/documentation/haproxy-configuration-manual/latest/#http-request%20return
  block_code: 425
  block_errorfile: true

  # todo: search parameters and body of http requests for SQLi/Path-Traversal/XSS/...

  # see also: https://github.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/blob/master/_generator_lists/bad-user-agents.list
  user_agents:
    # Well-known user-agents used by scripting languages for very basic security-filtering
    # matching is done case-insensitive
    script:
      # NOTE: empty user-agent is also matched
      full: []

      # NOTE: these are sub-strings inside the user-agent header
      sub:
        # cli tools
        - 'curl'
        - 'wget'
        - 'Apache-HttpClient'
        - 'nmap'
        - 'Metasploit'
        # automation tools
        - 'headless'
        - 'cypress'
        # golang
        - 'go-http-client'
        - 'zgrab'
        # python
        - 'python'
        - 'httpx'
        - 'httpcore'
        - 'aiohttp'
        - 'httputil'
        - 'urllib'
        # php
        - 'GuzzleHttp'
        - 'phpcrawl'
        - 'Zend_Http_Client'
        - 'Wordpress'
        - 'Symfony-HttpClient'
        # others
        - 'cpp-httplib'  # c++
        - 'java'
        - 'perl'
        - 'axios'  # JS
        - 'ruby'

    bad_crawlers:
      full: []
      sub:
        - 'spider'
        - 'test-bot'
        - 'tiny-bot'
        - 'fidget-spinner-bot'
        - 'download'
        - 'scan'
        - 'nmap'
        - 'Metasploit'
        - 'ImageVacuum'
        # python
        - 'scrapy'
        # golang
        - 'zgrab'

    any:
      - 'bot'
      - 'spider'
      - 'photon'
      - 'adsdefender'
      - 'crawler'
      - 'robot'
      - 'image'
      - 'proxy'
      - 'download'
      - 'scan'
      - 'Chrome-Lighthouse'
      - 'whatsapp'
      - 'fetcher'
      - 'office'
      - 'facebook'
      - 'feed'

  script_kiddy:
    excludes: []  # user-defined excludes

    path_beg:
      - '/cgi-bin/'
      - '/icons/'
      - '/manager/'
      - '/php'
      - '/program/'
      - '/pwd/'
      - '/shaAdmin/'
      - '/typo3/'
      - '/admin/'
      - '/dbadmin/'
      - '/db/'
      - '/solr/'
      - '/weaver/'
      - '/joomla/'
      - '/App/'
      - '/webdav/'
      - '/xmlrpc'
      - '/%'
      - '/.'
      - '/securityRealm/'
      - '/magmi/'
      - '/menu/'
      - '/etc/'
      - '/HNAP1'

    path_end:
      # scripts etc
      - '.php'
      - '.asp'
      - '.aspx'
      - '.esp'
      - '.lua'
      - '.rsp'
      - '.ashx'
      - '.dll'
      - '.bin'
      - '.cgi'
      - '.cs'
      - '.application'
      - '.exe'
      # information gathering
      - '.env'
      - '.git/config'
      - '.git/HEAD'
      - '.git/index'
      - '.DS_Store'
      - '.aws/config'
      - '.config'
      - '.settings'
      # data extraction
      - '.zip'
      - '.tar'
      - '.tgz'
      - '.gz'
      - '.bz2'
      - '.rar'
      - '.7z'
      - '.sql'
      - '.sqlite3'
      - '.bak'

    path_sub:
      - '/../'
